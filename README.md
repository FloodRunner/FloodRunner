[![FloodRunner](/resources/images/logos/logo.png)](https://floodrunner.dev)

<p align="center">
  <a aria-label="FloodRunner Logo" href="https://floodrunner.dev">
    <img src="https://img.shields.io/badge/MADE%20By%20FLOODRUNNER-6415FF?style=for-the-badge&labelColor=6415FF&logo=data:image/png;base64,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">
  </a>
  <a aria-label="Licence" href="/LICENSE">
    <img alt="" src="https://img.shields.io/badge/LICENCE-MIT-4285f4?style=for-the-badge&labelColor=000000">
  </a>
   <a aria-label="Try it now" href="https://app.floodrunner.dev">
    <img alt="" src="https://img.shields.io/badge/TRY %20IT%20NOW-6415FF?style=for-the-badge&labelColor=6415FF">
  </a>
   <a aria-label="Slack Community Invite it now" href="https://join.slack.com/t/floodrunner/shared_invite/zt-i3kjgmzl-YwUecFdFEn4mQiR_OQM0_w">
    <img alt="" src="https://tinyurl.com/yyy4s4ek" >
  </a>
</p>

---

A complete framework for monitoring web applications using browser tests. Easily monitor your web applications by continously running browser tests that simulate user behaviour. Browser level tests have advantages over traditional protocol level tests because they are capable of testing any user behaviour simply with easy to maintain readable scripts.

The process of using FloodRunner is simple and easy:

![FloodRunner Process Overview](/resources/images/overview.png)

#### Features:

- <strong>Schedule browser tests</strong>: Easily schedule your browser tests to ensure your application is being continously tested.
- <strong>On-demand browser tests</strong>: Create a Personal Access Token and run your browser test via an API call.
- <strong>Multiple browser test types</strong>: Supports both [Puppeteer](https://pptr.dev/) and [Element](https://element.flood.io/) scripts.
- <strong>Detailed Results</strong>: View detailed results of your test executions including all log output, screenshots and execution time.
- <strong>Integrate with Flood.io (coming soon)</strong>: Leverage Flood.io to run your scripts as load tests (applies to Element scripts only)
- <strong>Secure login and API authorization</strong>: Secured using Auth0.com ensuring that login is secure and that data is completely isolated between users.
- <strong>Cloud native</strong>: Cloud-architecture enabled allowing you to easily deploy the components to a cloud provider like Azure

#### Who is this for?

This is for anyone who wants to run browser tests on either a fixed schedule or on demand via a powerful API. No complex setup required, just paste in your script and see the results.

## Index

- [Quickstart](#quickstart)
- [Browser Tests](#browser-tests)
- [REST API](#rest-api)
- [Deploying FloodRunner](#deploying-floodrunner)
  - [1. Deploying Traefik](#1-deploying-traefik)
  - [2. Deploying RabbitMq](#2-deploying-rabbitMq)
  - [3. Deploying MongoDB](#3-deploying-mongoDB)
  - [4. Deploying FloodRunner NestJs API](#4-deploying-floodrunner-nestjs-api)
    - [4.1 Setting up Azure Blob Storage](#4.1-setting-up-azure-blob-storage)
  - [5. Deploying FloodRunner React Web App](#5-deploying-floodRunner-react-web-app)
- [Contributing](#contributing)
- [Reporting Issues](#reporting-issues)

## Quickstart

Once your FloodRunner instance is up and running you will be able to login and will be presented with an overview page like this:

![FloodRunner Empty Home Page](/resources/images/usage/empty_home_page.png)

Click `Create Test` and create your browser test using the form:

![FloodRunner Creation Form](/resources/images/usage/creation_form.png)

Your tests will display on the overview page showing their status (passing/failing), test schedule, last run date and test type.

![FloodRunner Home Page](/resources/images/usage/home_page.png)

Click `View Results` to see detailed results of your test executions. Here you can view and download your test script using the `View Script` button and delete the test if its no longer needed. A graph is shown with the latest test executions and clicking on a bar will download that tests logs and any screenshots.

![FloodRunner Results Page](/resources/images/usage/results_page.png)

## Browser Tests

FloodRunner allows you to create the following browser tests:

- Flood's [Element](https://element.flood.io/)
- [Puppeteer](https://pptr.dev/)

### Puppeteer

Puppeteer scripts are fully supported with a few caveats:

- Puppeteer and a browser instance is already provided so your script should use the provided browser instance
- Screenshots must be saved to a particular location (due to the read-only nature of Azure Functions) so when you save a screenshot, ensure that you append it to the path variable `screenshotPath` as shown below

Shown below is what a normal script would look like when uploaded to FloodRunner.

#### Normal Script

```
const puppeteer = require('puppeteer');
const browser = await puppeteer.launch({
  product: "chrome",
  headless: true,
});

const page = await browser.newPage();
await page.goto("https://example.com");
await page.screenshot({ path: "screenshot.png" });
browser.close();

```

#### Uploaded Script

```
const page = await browser.newPage();
await page.goto("https://example.com");
await page.screenshot({ path: path.join(screenshotPath, "screenshot.png") });
```

## Rest API

The NestJS backend API is fully Swagger compatible and can be accessed by creating an access token and providing it in the `x-api-key` request header when sending a request.

### Creating an Access Token

Open to the settings menu and select `Personal access token`
![Settings Pane](/resources/images/usage/settings_pane.png)

Then create a token by clicking the `Create Token` button
![Personal Access Token Screen](/resources/images/usage/personal_access_token.png)

You can then include this token in any request made to the backend API.

## Deploying FloodRunner

FloodRunner is fully cloud native and can be deployed into any cloud environment. The architecture shown below is when deployed to Azure

![FloodRunner Architecture](/resources/images/architecture.png)

> NB. Currently only Microsoft Azure Blob Storage can be used as a storage provider. The framework allows for other providers to be added as long as they implment the `IFileService` interface, PR's for other storage providers are welcomed.

Prerequisites:

- An Azure subscription to host FloodRunner.

### 1. Provision infrastructure

You will need to provision the following components in Azure:

- A Linux-Based App Service Plan (for the API and frontend) <strong>NB. If you use a Windows app service plan, ensure that you change the startup command for the React frontend in the yml pipeline</strong>
- An Azure Web app for the React front-end
- An Azure Web app for the NestJS backend
- An Azure Functions app for the SandboxRunner API
- An Azure storage account for storing tests and test results

Additionally, you will need a MongoDB database, you can either use one Azure or use a free one through [MongoDB Atlas](https://www.mongodb.com/cloud/atlas).

#### 1.1 Setting up Azure Blob Storage

If you choose to use Azure blob storage for storing the browser test logs and screenshots, it is important to configure the CORS origins in the portal to include to allow the frontend web portal to fetch the resources. For a broad configuration use:

- Allowed origins: \*
- Allowed methods: GET
- Allowed headers: \*
- Exposed headers: \*
- Max age: 600

If this is not configured you will receive CORS errors when fetching the resources.

### 2. Deploy React frontend, NestJS API and SandboxRunner API

You can either manually deploy each of the components to Azure, or use the `floodrunner-pipeline.yml`, in the `.azuredevops` folder, as a template pipeline for an Azure DevOps pipeline.

The yml file includes all the required steps to deploy each of the components.

> NB. For deploying the NestJS Backend API there are a number of secrets that need to be configured as pipeline variables. These get inserted into the `production.yml` config file and used when the application runs.

## Contributing

If you've enjoyed or even hated using this project please let me know throught a pull requests or just open an issue.

## Reporting Issues

If you encounter any issues with the framework please [open an issue](https://github.com/FloodRunner/FloodRunner/issues) on the GitHub project.
